<script src="https://cdn.teller.io/connect/connect.js"></script>
<script>
const out = document.getElementById('out') || (()=>{const p=document.createElement('pre');p.id='out';document.body.appendChild(p);return p})();
const log = (m,o)=>{ out.textContent += `\n${m} ${o?JSON.stringify(o,null,2):""}`; console.log(m,o||""); };

const nonce = crypto.getRandomValues(new Uint8Array(16)).reduce((s,b)=>s+('0'+b.toString(16)).slice(-2),'');
const tc = TellerConnect.setup({
  applicationId: "app_xxxxx",
  environment: "development",
  products: ["balance"],
  nonce,
  onInit: () => log("onInit"),
  onEvent: (e) => log("onEvent", e),       // logs step transitions and errors
  onFailure: (f) => log("onFailure", f),   // surfaces error details
  onExit: () => log("onExit"),
  onSuccess: (enr) => {
    log("onSuccess", { enrollment: enr.enrollment?.id, user: enr.user?.id });
    alert("Copy this token into Render -> TELLER_ACCESS_TOKEN:\n" + enr.accessToken);
  }
});
document.getElementById('teller-connect').onclick = () => tc.open();
</script>
